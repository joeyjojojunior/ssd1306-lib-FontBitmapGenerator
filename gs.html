<style>
    .tableCell {
        border: 1px solid #333;
        height: 25px;
        width: 25px;
    }

    #contentDiv {
        border: 1px solid black;
    }

    #contentDiv,
    #tableDiv,
    #buttonDiv,
    #inputDiv {
        margin: auto;
        width: 50%;
        padding: 10px;
    }

    #inputField {
        width: 50px;
    }

    button {
        margin: 0 auto;
        display: block;
    }



    #inputField {
        width: 100%;
    }
</style>

<body>

    <head>

    </head>
    <div id="container">
        <div id="contentDiv">
            <div id="tableDiv"></div>
            <div id="buttonDiv"></div>
            <div id="inputDiv"></div>
        </div>
    </div>

</body>

<script>
    const chars = [
        "sp", "!", "\"", "#", "$", "%", "&", "'", "(", ")", "*", "+", ",", "-", ".", "/", "0", "1", "2", "3", "4",
        "5", "6", "7", "8", "9", ":", ";", "<", "=", ">", "?", "@", "A", "B", "C", "D", "E", "F", "G", "H", "I",
        "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z", "[", "\\",
        "]", "^", "_", "`", "a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n",
        "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y", "z", "{", "|", "}", "~"
    ]

    let padTop = 1;
    let padBottom = 2;
    let padLeft = 3;
    let padRight = 4;
    let numRows = 14;
    let numCols = 16;
    let bitStrings = new Array(numRows);
    let isMouseDown = false;

    function tableCreate() {
        var body = document.getElementsByTagName("body")[0];
        var tableDiv = document.getElementById("tableDiv");

        var tbl = document.createElement('table');
        tbl.id = "cellTable";
        tbl.addEventListener("mouseleave", cellMouseOut, false);
        tbl.addEventListener("mousedown", cellMouseDown, false);
        tbl.addEventListener("mouseup", cellMouseUp, false);
        tbl.addEventListener("mouseover", cellMouseOver, false);

        var tbdy = document.createElement('tbody');
        for (var row = 0; row < numRows; row++) {
            var tr = document.createElement('tr');
            tr.className = "tableRow";
            tr.id = `${row}`;

            for (var col = 0; col < numCols; col++) {
                var td = document.createElement('td');
                td.className = "tableCell";
                td.id = `${row},${col}`;
                td.style.backgroundColor

                if (row < padTop || row >= numRows - padBottom || col < padLeft || col >= numCols - padRight) {
                    td.style.backgroundColor = "gray";
                } else {
                    td.style.backgroundColor = "white";
                }
                tr.appendChild(td);
            }

            tbdy.appendChild(tr);
        }
        tbl.appendChild(tbdy);
        tableDiv.appendChild(tbl);
    }

    function buttonCreate() {
        let btnDiv = document.getElementById("buttonDiv");

        let btn = document.createElement("button");
        btn.innerHTML = "Generate";
        btn.addEventListener("click", doBtnGen, false);
        btnDiv.appendChild(btn);
    }

    function inputCreate() {
        let inputDiv = document.getElementById("inputDiv");

        var input = document.createElement("textarea");
        input.rows = numRows + 1;
        input.id = "inputField";
        inputDiv.appendChild(input);
    }

    function doBtnGen() {
        generateBitStrings();
        console.log(bitStrings);
    }

    function generateBitStrings() {
        var table = document.getElementById("cellTable");
        for (var i = 0, row; row = table.rows[i]; i++) {
            let bitString = "";
            for (var j = 0, col; col = row.cells[j]; j++) {
                //let bit = getBit(col);
                //console.log(`color: ${col.style.backgroundColor}`);
                //console.log(`bit: ${getBit(col)}`);
                bitString += getBit(col);
            }
            bitStrings[i] = bitString;
            let hex = parseInt(bitStrings[i], 2).toString(16).toUpperCase;
            console.log(hex);

            byte = 0;
        }
    }

    function getBit(td) {
        switch (td.style.backgroundColor) {
            case "white":
            case "gray":
                return "0";
                break;
            case "black":
                return "1";
                break;
        }
    }

    function cellMouseOut(e) {
        e.preventDefault();
        isMouseDown = false;
    }

    function cellMouseDown(e) {
        e.preventDefault();
        isMouseDown = true;

        var td = event.target;
        while (td !== this && !td.matches("td")) {
            td = td.parentNode;
        }
        if (td !== this) {
            toggleCellColor(td);
        }
    }

    function cellMouseUp(e) {
        e.preventDefault();
        isMouseDown = false;
    }

    function cellMouseOver(e) {
        e.preventDefault();

        var td = event.target;
        while (td !== this && !td.matches("td")) {
            td = td.parentNode;
        }
        if (td !== this && isMouseDown) {
            toggleCellColor(td);
        }
    }

    function toggleCellColor(td) {
        if (td.style.backgroundColor == "gray") return;
        td.style.backgroundColor == "white" ? td.style.backgroundColor = "black" : td.style.backgroundColor = "white";
    }

    tableCreate();
    buttonCreate();
    inputCreate();
</script>